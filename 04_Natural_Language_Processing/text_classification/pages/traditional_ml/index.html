<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TF-IDF + Traditional ML | BBC News Classification</title>
    
    <!-- KaTeX for math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    
    <!-- Walkthrough CSS -->
    <link rel="stylesheet" href="assets/css/walkthrough.css">
    
    <!-- Main CSS -->
    <style>
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }
        
        /* Metric direction arrows */
        .metric-arrow {
            font-size: 0.8em;
            opacity: 0.6;
            margin-left: 0.25rem;
        }
        
        .metric-arrow-up {
            color: #ff8c00;
        }
        
        .metric-arrow-down {
            color: #ff8c00;
        }
        
        .navbar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .navbar .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .brand {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            text-decoration: none;
        }
        
        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }
        
        .nav-links a {
            text-decoration: none;
            color: #666;
            transition: color 0.3s;
        }
        
        .nav-links a:hover {
            color: #667eea;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .page-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            border-radius: 12px;
        }
        
        .page-header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .page-header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .pipeline-flow {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin: 2rem 0;
            padding: 2rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }
        
        .step {
            flex: 1;
            min-width: 150px;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
        }
        
        .step-fixed {
            background: #f3f4f6;
            border: 2px solid #d1d5db;
        }
        
        .step-interactive {
            background: #dbeafe;
            border: 2px dashed #3b82f6;
        }
        
        .step-result {
            background: #d1fae5;
            border: 2px solid #10b981;
        }
        
        .step-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .step-title {
            font-weight: bold;
            margin-bottom: 0.25rem;
        }
        
        .step-badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-top: 0.5rem;
        }
        
        .step-detail {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.5rem;
        }
        
        .arrow {
            font-size: 2rem;
            color: #667eea;
            font-weight: bold;
        }
        
        .method-selector-container {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 2rem 0;
        }
        
        .selector-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .selector-header h3 {
            color: #333;
            font-size: 1.5rem;
        }
        
        .selector-actions {
            display: flex;
            gap: 1rem;
        }
        
        .btn-secondary {
            padding: 0.5rem 1rem;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        
        .method-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .method-checkbox-label {
            display: block;
            cursor: pointer;
        }
        
        .method-checkbox-label input[type="checkbox"] {
            display: none;
        }
        
        .method-card-mini {
            padding: 1.5rem;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .method-checkbox-label input:checked + .method-card-mini {
            border-color: #667eea;
            background: #f0f4ff;
        }
        
        .method-checkbox-label:hover .method-card-mini {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .method-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .method-quick-stats {
            display: flex;
            gap: 1rem;
            margin: 0.5rem 0;
            font-size: 0.9rem;
            color: #666;
        }
        
        .method-description {
            color: #666;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        
        .selector-footer {
            text-align: center;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 2px solid #e5e7eb;
        }
        
        .btn-primary {
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .text-muted {
            color: #9ca3af;
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        
        .comparison-results {
            margin-top: 2rem;
        }
        
        .comparison-content {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table-container {
            overflow-x: auto;
            margin: 1.5rem 0;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 0.75rem;
            text-align: center;
            border-bottom: 1px solid #e5e7eb;
            font-size: 0.9rem;
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-weight: 600;
            color: #ff8c00;
            position: sticky;
            top: 0;
            z-index: 10;
            font-size: 0.9rem;
        }
        
        .comparison-table th:first-child,
        .comparison-table td:first-child {
            text-align: left;
            position: sticky;
            left: 0;
            background: white;
            z-index: 5;
        }
        
        .comparison-table th:first-child {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 15;
        }
        
        .comparison-table tbody tr:hover {
            background: #f0f4ff;
        }
        
        .comparison-table tbody tr:hover td:first-child {
            background: #f0f4ff;
        }
        
        .method-name-cell {
            font-weight: 600;
            color: #667eea;
            white-space: nowrap;
        }
        
        .metric-best {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #78350f;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(251, 191, 36, 0.3);
        }
        
        .metric-value {
            font-weight: 500;
        }
        
        .table-caption {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            margin-top: 1rem;
        }
        
        .confusion-matrices-container {
            margin: 3rem 0;
        }
        
        .confusion-matrix-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 1.5rem 0;
        }
        
        .matrix-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 1.5rem;
        }
        
        .matrix-header h5 {
            margin: 0;
            font-size: 1.2rem;
        }
        
        .matrix-content {
            padding: 1.5rem;
        }
        
        /* Confusion matrix styling */
        .cm-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 6px;
            margin: 1rem 0;
        }
        
        .cm-table th,
        .cm-table td {
            padding: 12px;
            text-align: center;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .cm-table th {
            background: #667eea;
            color: white;
            font-size: 0.9rem;
        }
        
        .cm-table tbody th {
            background: #667eea;
            color: white;
            font-size: 0.9rem;
        }
        
        .cm-table td {
            background: #f3f4f6;
            color: #333;
            font-size: 1.1rem;
        }
        
        .cm-diagonal {
            background: linear-gradient(135deg, #10b981, #059669) !important;
            color: white !important;
            font-size: 1.2rem !important;
            box-shadow: 0 0 12px rgba(16, 185, 129, 0.4);
        }
        
        .cm-error-low {
            background: #fef3c7 !important;
            color: #92400e !important;
        }
        
        .cm-error-medium {
            background: #fed7aa !important;
            color: #9a3412 !important;
        }
        
        .cm-error-high {
            background: #fecaca !important;
            color: #991b1b !important;
            font-weight: 600 !important;
        }
        
        .cm-zero {
            background: #f9fafb !important;
            color: #d1d5db !important;
        }
        
        .per-class-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
            padding: 1rem;
            background: #f9fafb;
            border-radius: 8px;
        }
        
        .per-class-item {
            text-align: center;
            padding: 0.75rem;
            background: white;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }
        
        .per-class-label {
            font-weight: 600;
            color: #667eea;
            text-transform: capitalize;
            margin-bottom: 0.5rem;
        }
        
        .per-class-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #10b981;
        }
        
        /* Matrix view tabs */
        .matrix-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .matrix-tab-btn {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
        }
        
        .matrix-tab-btn:hover {
            color: #667eea;
            background: #f8f9fa;
        }
        
        .matrix-tab-btn.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: 600;
        }
        
        .matrix-view {
            display: none;
        }
        
        .matrix-view.active {
            display: block;
        }
        
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <a href="../../index.html" class="brand">📰 BBC News Classification</a>
            <ul class="nav-links">
                <li><a href="../../index.html">Overview</a></li>
                <li><a href="#" style="color: #667eea">Traditional ML</a></li>
                <li><a href="#">Pipelines</a></li>
                <li><a href="#">Zero-shot</a></li>
                <li><a href="#">BERT</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <div class="page-header">
            <h1>🔤 TF-IDF + Traditional Machine Learning</h1>
            <p>Fast, interpretable baselines for text classification</p>
        </div>

        <!-- Pipeline Visualization -->
        <div class="pipeline-flow">
            <div class="step step-fixed">
                <div class="step-icon">📝</div>
                <div class="step-title">Text Input</div>
                <div class="step-detail">"Business news..."</div>
            </div>
            
            <div class="arrow">→</div>
            
            <div class="step step-fixed">
                <div class="step-icon">🔢</div>
                <div class="step-title">TF-IDF</div>
                <div class="step-badge">Fixed</div>
                <div class="step-detail">5000 features</div>
            </div>
            
            <div class="arrow">→</div>
            
            <div class="step step-interactive">
                <div class="step-icon">🤖</div>
                <div class="step-title">Classifier</div>
                <div class="step-badge">Choose Below</div>
                <div class="step-detail">Select methods</div>
            </div>
            
            <div class="arrow">→</div>
            
            <div class="step step-result">
                <div class="step-icon">✨</div>
                <div class="step-title">Results</div>
                <div class="step-detail">96-98% accuracy</div>
            </div>
        </div>

        <!-- Method Selector -->
        <div id="method-selector"></div>
    </div>

    <!-- Embedded Data -->
    <script type="application/json" id="summary-data">
{
  "timestamp": "2025-10-20T11:00:20.960321",
  "dataset": {
    "name": "BBC News",
    "train_samples": 1557,
    "test_samples": 334,
    "num_classes": 5,
    "classes": [
      "business",
      "entertainment",
      "politics",
      "sport",
      "tech"
    ]
  },
  "methods": [
    {
      "id": "naive_bayes",
      "name": "Naive Bayes",
      "accuracy": 97.90419161676647,
      "precision": 97.92406928803797,
      "recall": 97.90419161676647,
      "f1_score": 97.88469808716201,
      "train_time": "~0.01s",
      "inference_time": "~1.83\u00b5s",
      "model_size": "0.38MB",
      "description": "Fast probabilistic classifier, excellent baseline for text",
      "best_for": "Quick prototyping, interpretability, speed",
      "data_path": "../naive_bayes/results.json",
      "status": "available"
    },
    {
      "id": "logistic_regression",
      "name": "Logistic Regression",
      "accuracy": 98.20359281437125,
      "precision": 98.2324138205923,
      "recall": 98.20359281437125,
      "f1_score": 98.2001707885549,
      "train_time": "~0.69s",
      "inference_time": "~2.48\u00b5s",
      "model_size": "0.19MB",
      "description": "Linear classifier with regularization, balanced performance",
      "best_for": "Production, interpretability, balanced speed/accuracy",
      "data_path": "../logistic_regression/results.json",
      "status": "available"
    },
    {
      "id": "svm",
      "name": "Svm",
      "accuracy": 97.30538922155688,
      "precision": 97.34728928274042,
      "recall": 97.30538922155688,
      "f1_score": 97.30539131987211,
      "train_time": "~0.09s",
      "inference_time": "~2.17\u00b5s",
      "model_size": "0.19MB",
      "description": "Maximum margin classifier, robust to outliers",
      "best_for": "High-dimensional data, robust classification",
      "data_path": "../svm/results.json",
      "status": "available"
    },
    {
      "id": "random_forest",
      "name": "Random Forest",
      "accuracy": 96.7065868263473,
      "precision": 96.88447813270639,
      "recall": 96.7065868263473,
      "f1_score": 96.72550095669341,
      "train_time": "~1.29s",
      "inference_time": "~0.053ms",
      "model_size": "4.47MB",
      "description": "Ensemble of decision trees, provides feature importance",
      "best_for": "Feature analysis, ensemble learning",
      "data_path": "../random_forest/results.json",
      "status": "available"
    }
  ]
}
    </script>
    
    <script type="application/json" id="methods-data">
{
  "naive_bayes": {
    "method": "naive_bayes",
    "display_name": "Naive Bayes",
    "timestamp": "2025-10-20T11:00:18.837876",
    "metrics": {
      "accuracy": 0.9790419161676647,
      "precision": 0.9792406928803797,
      "recall": 0.9790419161676647,
      "f1_score": 0.97884698087162
    },
    "performance": {
      "train_time_seconds": 0.00543212890625,
      "inference_time_ms_per_sample": 0.001827399887724551,
      "total_test_samples": 334,
      "model_size_bytes": 400906
    },
    "confusion_matrix": [
      [
        76,
        1,
        0,
        0,
        0
      ],
      [
        2,
        53,
        1,
        0,
        2
      ],
      [
        1,
        0,
        61,
        0,
        0
      ],
      [
        0,
        0,
        0,
        77,
        0
      ],
      [
        0,
        0,
        0,
        0,
        60
      ]
    ],
    "per_class_metrics": [
      {
        "label": "business",
        "precision": 0.9620253164556962,
        "recall": 0.987012987012987,
        "f1": 0.9743589743589743,
        "support": 77
      },
      {
        "label": "entertainment",
        "precision": 0.9814814814814815,
        "recall": 0.9137931034482759,
        "f1": 0.9464285714285714,
        "support": 58
      },
      {
        "label": "politics",
        "precision": 0.9838709677419355,
        "recall": 0.9838709677419355,
        "f1": 0.9838709677419355,
        "support": 62
      },
      {
        "label": "sport",
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "support": 77
      },
      {
        "label": "tech",
        "precision": 0.967741935483871,
        "recall": 1.0,
        "f1": 0.9836065573770492,
        "support": 60
      }
    ],
    "labels": [
      "business",
      "entertainment",
      "politics",
      "sport",
      "tech"
    ],
    "model_config": {
      "feature_extraction": "TF-IDF",
      "max_features": 5000,
      "ngram_range": [
        1,
        2
      ]
    }
  },
  "logistic_regression": {
    "method": "logistic_regression",
    "display_name": "Logistic Regression",
    "timestamp": "2025-10-20T11:00:19.536738",
    "metrics": {
      "accuracy": 0.9820359281437125,
      "precision": 0.982324138205923,
      "recall": 0.9820359281437125,
      "f1_score": 0.982001707885549
    },
    "performance": {
      "train_time_seconds": 0.6854567527770996,
      "inference_time_ms_per_sample": 0.0024776972696452797,
      "total_test_samples": 334,
      "model_size_bytes": 200802
    },
    "confusion_matrix": [
      [
        75,
        0,
        1,
        0,
        1
      ],
      [
        1,
        55,
        1,
        0,
        1
      ],
      [
        1,
        0,
        61,
        0,
        0
      ],
      [
        0,
        0,
        0,
        77,
        0
      ],
      [
        0,
        0,
        0,
        0,
        60
      ]
    ],
    "per_class_metrics": [
      {
        "label": "business",
        "precision": 0.974025974025974,
        "recall": 0.974025974025974,
        "f1": 0.974025974025974,
        "support": 77
      },
      {
        "label": "entertainment",
        "precision": 1.0,
        "recall": 0.9482758620689655,
        "f1": 0.9734513274336283,
        "support": 58
      },
      {
        "label": "politics",
        "precision": 0.9682539682539683,
        "recall": 0.9838709677419355,
        "f1": 0.976,
        "support": 62
      },
      {
        "label": "sport",
        "precision": 1.0,
        "recall": 1.0,
        "f1": 1.0,
        "support": 77
      },
      {
        "label": "tech",
        "precision": 0.967741935483871,
        "recall": 1.0,
        "f1": 0.9836065573770492,
        "support": 60
      }
    ],
    "labels": [
      "business",
      "entertainment",
      "politics",
      "sport",
      "tech"
    ],
    "model_config": {
      "feature_extraction": "TF-IDF",
      "max_features": 5000,
      "ngram_range": [
        1,
        2
      ]
    }
  },
  "svm": {
    "method": "svm",
    "display_name": "Svm",
    "timestamp": "2025-10-20T11:00:19.641592",
    "metrics": {
      "accuracy": 0.9730538922155688,
      "precision": 0.9734728928274042,
      "recall": 0.9730538922155688,
      "f1_score": 0.9730539131987211
    },
    "performance": {
      "train_time_seconds": 0.09179806709289551,
      "inference_time_ms_per_sample": 0.002167895882429477,
      "total_test_samples": 334,
      "model_size_bytes": 200686
    },
    "confusion_matrix": [
      [
        73,
        1,
        2,
        0,
        1
      ],
      [
        0,
        56,
        1,
        1,
        0
      ],
      [
        1,
        0,
        61,
        0,
        0
      ],
      [
        0,
        0,
        0,
        77,
        0
      ],
      [
        0,
        1,
        1,
        0,
        58
      ]
    ],
    "per_class_metrics": [
      {
        "label": "business",
        "precision": 0.9864864864864865,
        "recall": 0.948051948051948,
        "f1": 0.9668874172185431,
        "support": 77
      },
      {
        "label": "entertainment",
        "precision": 0.9655172413793104,
        "recall": 0.9655172413793104,
        "f1": 0.9655172413793104,
        "support": 58
      },
      {
        "label": "politics",
        "precision": 0.9384615384615385,
        "recall": 0.9838709677419355,
        "f1": 0.9606299212598425,
        "support": 62
      },
      {
        "label": "sport",
        "precision": 0.9871794871794872,
        "recall": 1.0,
        "f1": 0.9935483870967742,
        "support": 77
      },
      {
        "label": "tech",
        "precision": 0.9830508474576272,
        "recall": 0.9666666666666667,
        "f1": 0.9747899159663865,
        "support": 60
      }
    ],
    "labels": [
      "business",
      "entertainment",
      "politics",
      "sport",
      "tech"
    ],
    "model_config": {
      "feature_extraction": "TF-IDF",
      "max_features": 5000,
      "ngram_range": [
        1,
        2
      ]
    }
  },
  "random_forest": {
    "method": "random_forest",
    "display_name": "Random Forest",
    "timestamp": "2025-10-20T11:00:20.952670",
    "metrics": {
      "accuracy": 0.9670658682634731,
      "precision": 0.968844781327064,
      "recall": 0.9670658682634731,
      "f1_score": 0.9672550095669341
    },
    "performance": {
      "train_time_seconds": 1.2862157821655273,
      "inference_time_ms_per_sample": 0.05324086743200611,
      "total_test_samples": 334,
      "model_size_bytes": 4687178
    },
    "confusion_matrix": [
      [
        76,
        0,
        0,
        0,
        1
      ],
      [
        3,
        55,
        0,
        0,
        0
      ],
      [
        3,
        0,
        58,
        1,
        0
      ],
      [
        0,
        0,
        0,
        77,
        0
      ],
      [
        2,
        0,
        1,
        0,
        57
      ]
    ],
    "per_class_metrics": [
      {
        "label": "business",
        "precision": 0.9047619047619048,
        "recall": 0.987012987012987,
        "f1": 0.9440993788819876,
        "support": 77
      },
      {
        "label": "entertainment",
        "precision": 1.0,
        "recall": 0.9482758620689655,
        "f1": 0.9734513274336283,
        "support": 58
      },
      {
        "label": "politics",
        "precision": 0.9830508474576272,
        "recall": 0.9354838709677419,
        "f1": 0.9586776859504132,
        "support": 62
      },
      {
        "label": "sport",
        "precision": 0.9871794871794872,
        "recall": 1.0,
        "f1": 0.9935483870967742,
        "support": 77
      },
      {
        "label": "tech",
        "precision": 0.9827586206896551,
        "recall": 0.95,
        "f1": 0.9661016949152542,
        "support": 60
      }
    ],
    "labels": [
      "business",
      "entertainment",
      "politics",
      "sport",
      "tech"
    ],
    "model_config": {
      "feature_extraction": "TF-IDF",
      "max_features": 5000,
      "ngram_range": [
        1,
        2
      ]
    }
  }
}
    </script>

    <!-- Walkthrough JS -->
    <script src="assets/js/walkthrough.js"></script>

    <!-- Main JavaScript -->
    <script>
        
        // Load embedded data
        const summaryData = JSON.parse(document.getElementById('summary-data').textContent);
        const methodsData = JSON.parse(document.getElementById('methods-data').textContent);
        
        let selectedMethods = new Set();
        
        // Render method selector
        function renderMethodSelector() {
            const container = document.getElementById('method-selector');
            
            const methodsHTML = summaryData.methods.map(method => `
                <label class="method-checkbox-label">
                    <input type="checkbox" 
                           class="method-checkbox" 
                           value="${method.id}"
                           onchange="toggleMethod('${method.id}')">
                    <div class="method-card-mini">
                        <div class="method-name">${method.name}</div>
                        <div class="method-quick-stats">
                            <span>📊 ${method.accuracy.toFixed(1)}%</span>
                            <span>⚡ ${method.train_time}</span>
                        </div>
                        <div class="method-description">${method.description}</div>
                    </div>
                </label>
            `).join('');
            
            container.innerHTML = `
                <div class="method-selector-container">
                    <div class="selector-header">
                        <h3>Select Methods to Compare</h3>
                        <div class="selector-actions">
                            <button class="btn-secondary" onclick="selectAll()">Select All</button>
                            <button class="btn-secondary" onclick="clearAll()">Clear All</button>
                        </div>
                    </div>
                    
                    <div class="method-checkboxes">
                        ${methodsHTML}
                    </div>
                    
                    <div class="selector-footer">
                        <button class="btn-primary" onclick="compare()" id="compare-btn" disabled>
                            Compare Selected Methods
                        </button>
                        <p class="text-muted">Select at least one method to compare</p>
                    </div>
                    
                    <div id="comparison-results" class="comparison-results"></div>
                </div>
            `;
        }
        
        function toggleMethod(methodId) {
            if (selectedMethods.has(methodId)) {
                selectedMethods.delete(methodId);
            } else {
                selectedMethods.add(methodId);
            }
            updateCompareButton();
        }
        
        function updateCompareButton() {
            const btn = document.getElementById('compare-btn');
            if (selectedMethods.size > 0) {
                btn.disabled = false;
                btn.textContent = `Compare ${selectedMethods.size} Method${selectedMethods.size > 1 ? 's' : ''}`;
            } else {
                btn.disabled = true;
                btn.textContent = 'Compare Selected Methods';
            }
        }
        
        function selectAll() {
            document.querySelectorAll('.method-checkbox').forEach(cb => {
                cb.checked = true;
                selectedMethods.add(cb.value);
            });
            updateCompareButton();
        }
        
        function clearAll() {
            document.querySelectorAll('.method-checkbox').forEach(cb => cb.checked = false);
            selectedMethods.clear();
            updateCompareButton();
        }
        
        function compare() {
            const methods = summaryData.methods.filter(m => selectedMethods.has(m.id));
            renderComparison(methods);
        }
        
        function renderComparison(methods) {
            const resultsContainer = document.getElementById('comparison-results');
            
            // Helper function to normalize inference time to microseconds
            const normalizeInferenceTime = (timeStr) => {
                const value = parseFloat(timeStr.replace(/[^0-9.]/g, ''));
                if (timeStr.includes('µs')) {
                    return value; // Already in microseconds
                } else if (timeStr.includes('ms')) {
                    return value * 1000; // Convert ms to µs
                } else {
                    return value; // Assume µs if no unit
                }
            };
            
            // Helper function to normalize model size to MB
            const normalizeModelSize = (sizeStr) => {
                const value = parseFloat(sizeStr.replace(/[^0-9.]/g, ''));
                // All sizes are in MB format now, just extract the number
                return value;
            };
            
            // Find best/worst in each metric
            const metrics = {
                accuracy: { values: methods.map(m => m.accuracy), better: 'higher' },
                precision: { values: methods.map(m => m.precision), better: 'higher' },
                recall: { values: methods.map(m => m.recall), better: 'higher' },
                f1_score: { values: methods.map(m => m.f1_score), better: 'higher' },
                train_time: { values: methods.map(m => parseFloat(m.train_time.replace(/[^0-9.]/g, ''))), better: 'lower' },
                inference_time: { values: methods.map(m => normalizeInferenceTime(m.inference_time)), better: 'lower' },
                model_size: { values: methods.map(m => normalizeModelSize(m.model_size)), better: 'lower' }
            };
            
            // Find best values
            const best = {};
            Object.keys(metrics).forEach(key => {
                const values = metrics[key].values;
                if (metrics[key].better === 'higher') {
                    best[key] = Math.max(...values);
                } else {
                    // For lower is better (time, model-size), find minimum
                    best[key] = Math.min(...values); // Don't filter out 0 values
                }
            });
            
            // Comparison table
            const tableRows = methods.map((method, idx) => {
                const isBestAcc = method.accuracy === best.accuracy;
                const isBestPrec = method.precision === best.precision;
                const isBestRec = method.recall === best.recall;
                const isBestF1 = method.f1_score === best.f1_score;
                const isBestTrain = metrics.train_time.values[idx] === best.train_time;
                const isBestInf = metrics.inference_time.values[idx] === best.inference_time;
                const isBestSize = metrics.model_size.values[idx] === best.model_size;
                
                return `
                    <tr>
                        <td class="method-name-cell">${method.name}</td>
                        <td class="metric-value ${isBestAcc ? 'metric-best' : ''}">${method.accuracy.toFixed(2)}%</td>
                        <td class="metric-value ${isBestPrec ? 'metric-best' : ''}">${method.precision.toFixed(2)}%</td>
                        <td class="metric-value ${isBestRec ? 'metric-best' : ''}">${method.recall.toFixed(2)}%</td>
                        <td class="metric-value ${isBestF1 ? 'metric-best' : ''}">${method.f1_score.toFixed(2)}%</td>
                        <td class="metric-value ${isBestTrain ? 'metric-best' : ''}">${method.train_time}</td>
                        <td class="metric-value ${isBestInf ? 'metric-best' : ''}">${method.inference_time}</td>
                        <td class="metric-value ${isBestSize ? 'metric-best' : ''}">${method.model_size}</td>
                    </tr>
                `;
            }).join('');
            
            // Confusion matrices
            const confusionMatrices = methods.map(method => {
                const data = methodsData[method.id];
                const cm = data.confusion_matrix;
                const labels = data.labels;
                const perClassMetrics = data.per_class_metrics;
                
                // Find max error for coloring
                const maxError = Math.max(...cm.flatMap((row, i) => row.filter((_, j) => i !== j)));
                
                const cmHTML = `
                    <table class="cm-table">
                        <thead>
                            <tr>
                                <th>Actual \\ Pred</th>
                                ${labels.map(l => `<th>${l}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${cm.map((row, i) => `
                                <tr>
                                    <th>${labels[i]}</th>
                                    ${row.map((val, j) => {
                                        if (i === j) {
                                            return `<td class="cm-diagonal">${val}</td>`;
                                        } else if (val === 0) {
                                            return `<td class="cm-zero">0</td>`;
                                        } else {
                                            const severity = val / maxError;
                                            const className = severity > 0.5 ? 'cm-error-high' 
                                                            : severity > 0.2 ? 'cm-error-medium' 
                                                            : 'cm-error-low';
                                            return `<td class="${className}">${val}</td>`;
                                        }
                                    }).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
                
                const perClassHTML = `
                    <div class="per-class-summary">
                        ${perClassMetrics.map(cls => `
                            <div class="per-class-item">
                                <div class="per-class-label">${cls.label}</div>
                                <div class="per-class-value">${(cls.f1 * 100).toFixed(1)}%</div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                // Walkthrough HTML with embedded data
                const walkthroughHTML = `
                    <div class="walkthrough-container" id="walkthrough-${method.id}">
                        <button class="walkthrough-fullscreen-btn" onclick="toggleFullscreen('${method.id}')">⛶ Fullscreen</button>
                        <div class="walkthrough-content">
                            <div class="walkthrough-grid">
                                <div class="walkthrough-left">
                                    <div class="matrix-display">
                                        <h4 style="margin-bottom: 1rem; color: #333;">Confusion Matrix</h4>
                                        <table class="wt-cm-table" id="wt-matrix-${method.id}"></table>
                                    </div>
                                    
                                    <div class="walkthrough-controls">
                                        <button class="wt-btn wt-btn-nav" onclick="wtPrevStep('${method.id}')">◀ Previous</button>
                                        <button class="wt-btn wt-btn-nav" onclick="wtNextStep('${method.id}')">Next ▶</button>
                                        <button class="wt-btn wt-btn-reset" onclick="wtReset('${method.id}')">↻ Reset</button>
                                    </div>
                                </div>
                                
                                <div class="walkthrough-right">
                                    <div class="wt-step-info" id="wt-step-info-${method.id}">
                                        <h3>
                                            <span class="wt-step-number" id="wt-step-num-${method.id}">1</span>
                                            <span id="wt-step-title-${method.id}">Loading...</span>
                                        </h3>
                                        <p id="wt-step-desc-${method.id}"></p>
                                    </div>
                                    
                                    <div class="wt-calculations" id="wt-calc-${method.id}"></div>
                                </div>
                            </div>
                            
                            <div class="wt-progress-bar">
                                <div class="wt-progress-fill" id="wt-progress-${method.id}"></div>
                            </div>
                            <div class="wt-progress-text" id="wt-progress-text-${method.id}">Step 1/12</div>
                        </div>
                    </div>
                `;
                
                return `
                    <div class="confusion-matrix-card">
                        <div class="matrix-header">
                            <h5>${method.name} - Accuracy: ${method.accuracy.toFixed(2)}%</h5>
                        </div>
                        <div class="matrix-content">
                            <h4>Per-Class F1-Score</h4>
                            ${perClassHTML}
                            
                            <h4 style="margin-top: 2rem;">Confusion Matrix</h4>
                            
                            <div class="matrix-tabs">
                                <button class="matrix-tab-btn active" onclick="switchMatrixView('${method.id}', 'matrix')">
                                    📊 Confusion Matrix
                                </button>
                                <button class="matrix-tab-btn" onclick="switchMatrixView('${method.id}', 'walkthrough')">
                                    🎓 Metrics Walkthrough
                                </button>
                            </div>
                            
                            <div id="matrix-view-${method.id}" class="matrix-view active">
                                ${cmHTML}
                                <p style="margin-top: 1rem; color: #666; font-size: 0.9rem; text-align: center;">
                                    🟢 Diagonal = Correct Predictions | 🟡🟠🔴 = Errors (color intensity = severity)
                                </p>
                            </div>
                            
                            <div id="walkthrough-view-${method.id}" class="matrix-view">
                                ${walkthroughHTML}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            resultsContainer.innerHTML = `
                <div class="comparison-content">
                    <h3>Comparison Results</h3>
                    
                    <div class="comparison-table-container">
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Method</th>
                                    <th>Accuracy <span class="metric-arrow metric-arrow-up">↑</span></th>
                                    <th>Precision <span class="metric-arrow metric-arrow-up">↑</span></th>
                                    <th>Recall <span class="metric-arrow metric-arrow-up">↑</span></th>
                                    <th>F1-Score <span class="metric-arrow metric-arrow-up">↑</span></th>
                                    <th>Train Time <span class="metric-arrow metric-arrow-down">↓</span></th>
                                    <th>Inference <span class="metric-arrow metric-arrow-down">↓</span></th>
                                    <th>Model Size</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${tableRows}
                            </tbody>
                        </table>
                        <p class="table-caption">
                            🏆 Highlighted = Best performer | ↑ Higher is better | ↓ Lower is better
                        </p>
                    </div>
                    
                    <div class="confusion-matrices-container">
                        <h4>Confusion Matrices & Metrics</h4>
                        ${confusionMatrices}
                    </div>
                </div>
            `;
            
            // Initialize all walkthroughs
            methods.forEach(method => {
                const data = methodsData[method.id];
                initWalkthrough(method.id, data.confusion_matrix, data.labels);
            });
            
            resultsContainer.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Initialize on load
        renderMethodSelector();
        
        // Auto-select all and show comparison by default
        setTimeout(() => {
            selectAll();
            compare();
        }, 100);
        
        // ESC key to exit fullscreen
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const fullscreenContainer = document.querySelector('.walkthrough-container.fullscreen');
                if (fullscreenContainer) {
                    const methodId = fullscreenContainer.id.replace('walkthrough-', '');
                    toggleFullscreen(methodId);
                }
            }
        });
        
        // Matrix view switching
        function switchMatrixView(methodId, view) {
            const matrixView = document.getElementById(`matrix-view-${methodId}`);
            const walkthroughView = document.getElementById(`walkthrough-view-${methodId}`);
            
            if (!matrixView || !walkthroughView) return;
            
            const matrixContent = matrixView.closest('.matrix-content');
            if (!matrixContent) return;
            
            const tabButtons = matrixContent.querySelectorAll('.matrix-tab-btn');
            tabButtons.forEach((btn, idx) => {
                if ((view === 'matrix' && idx === 0) || (view === 'walkthrough' && idx === 1)) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            if (view === 'matrix') {
                matrixView.classList.add('active');
                walkthroughView.classList.remove('active');
            } else {
                matrixView.classList.remove('active');
                walkthroughView.classList.add('active');
            }
        }
        
        // Fullscreen functionality for walkthrough
        function toggleFullscreen(methodId) {
            const container = document.getElementById(`walkthrough-${methodId}`);
            const btn = document.querySelector(`#walkthrough-${methodId} .walkthrough-fullscreen-btn`);
            
            if (!container || !btn) {
                console.error('Fullscreen elements not found for method:', methodId);
                return;
            }
            
            if (container.classList.contains('fullscreen')) {
                container.classList.remove('fullscreen');
                btn.textContent = '⛶ Fullscreen';
                document.body.style.overflow = '';
            } else {
                container.classList.add('fullscreen');
                btn.textContent = '✕ Exit';
                document.body.style.overflow = 'hidden';
            }
        }
        
    </script>
</body>
</html>
